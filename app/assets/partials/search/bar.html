<div ng-cloak class="row search-row" np-animate="#main" ng-controller="AdvancedCtrl">
    <a href="http://localhost:3000"><img src="http://www.nextprot.org/db/images/blueflat/np.png" class="home"/></a>
    <div class="row-fluid">
        <form ng-submit="go()" validate>
            <div>
                <div class="span3">
                    <!--                        -->
                    <!--  ENTITY SELECTION      -->
                    <!--                        -->
                    <div class="btn-group pull-right" ng-show="!isAdvancedMode()">

                        <a class="btn dropdown-toggle" data-toggle="dropdown" href="" id="search-entity">
                            {{Search.config.entityMapping[Search.params.entity]}}&nbsp;
                            <span class="caret"></span>
                        </a>
                        <ul id="search-entity-dropdown" class="dropdown-menu">
                            <!-- dropdown menu links -->
                            <li><a ng-click="entity({entity:'proteins'})">Proteins</a></li>
                            <li><a ng-click="entity({entity:'publications'})">Publications</a></li>
                            <li><a ng-click="entity({entity:'terms'})">Terms</a></li>
                        </ul>
                    </div>
                    <!--                        -->
                </div>
                <div class="span9 search-bar">
                    <div ng-show="isAdvancedMode()" class=" span11 sparql-small-box fade-in">
                        <div class="span7 relative" style="position: relative; border: 1px solid #ddd;border-radius: 8px;" >
                            <div
                                 ui-ace="{useWrapMode : false, showGutter: false, theme:'nextprot', mode: 'sparql', onLoad: aceLoaded, onChange: aceChanged}"
                                 ng-model="Advanced.currentSparql">

                            </div>
                            <div class="sparql-editor-buttons">
                                <button id="adv-user-query" class="btn" type="button" ng-click="toogleSearchMode()"><i
                                        class="{{(Search.params.mode == 'simple') ? 'icon-caret-down' : 'icon-caret-up'}} ajax-end"></i></button>
                                <button id="search-button" class="btn btn-primary" type="submit"><i class="icon-search"></i>
                                </button>
                                <button style="padding: 0px; margin-right: 5px" class="btn btn-mini btn-link" type="button" ng-click="Advanced.showHelp=!Advanced.showHelp;" ><i class="icon-info-sign"></i></button>
                            </div>
                        </div>


                        <div class="span5 fade-out-left fade-in-left" style="padding-left: 5px;margin-left: 10px;padding: 10px; border: 1px solid #ddd;border-radius: 8px;" ng-show="Advanced.showHelp" >

                            <!--filter-->
                            <input ng-model="filterQuery" placeholder="search in {{Advanced.currentRepository.title}} repository">
                            <!--Selectable repositories-->
                            <div class="btn-group" style="margin: 5px;">
                                <button  data-toggle="tooltip" title="{{rep.tooltip}}" class="btn {{(Advanced.currentRepository == rep) ? 'btn-inverse' : ''}}"
                                         ng-repeat="rep in Advanced.repositories"
                                         type="button" ng-click="showRepository(rep)"><i class="{{rep.icon}}"></i></button>
                            </div>


                            <button type="button" class="close" ng-click="Advanced.showHelp=false">Ã—</button>

                            <div class="row" style="margin-left: 0px; padding: 10px; height: 280px; overflow-y: auto">
                                <table class="table table-hover">
                                    <tbody>
                                    <tr ng-repeat="query in Advanced.queries | filter:filterQuery | orderBy:'title'">
                                        <td>
                                            <i class="{{query.published ? (query.username == 'nextprot' ? 'icon-certificate' : 'icon-globe') : ''}}"></i>
                                        </td>
                                        <td><a href="" ng-click="appendSparqlToCurrentQuery(query)">{{query.title}} [{{query.username}}]</a></td>

                                        <!--Don't show edit and remove button if the user is not the owner-->
                                        <td ng-if="hasPrivilegesToEdit(query)">
                                            <button class="btn btn-mini pull-right" type="button" ng-click="Advanced.setCurrentQuery(query)"
                                                    bs-modal="'partials/advanced/advanced-save-modal.html'"><i
                                                    class="icon-edit"></i></button>
                                        </td>
                                        <td ng-if="hasPrivilegesToEdit(query)">
                                            <button class="btn btn-mini pull-right" type="button" ng-click="deleteAdvancedQuery(query)"><i
                                                    class="icon-remove"></i></button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="row" style="height: 50px;">
                                <button class="btn btn-primary btn-small pull-right" style="margin: 10px;"
                                        type="button" ng-click="Advanced.clearCurrentQuery();"
                                        bs-modal="'partials/advanced/advanced-save-modal.html'">Create new
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- END ADV MODE -->


                    <div class=" input-append span8" ng-hide="isAdvancedMode()"
                         ng-class="{'input-prepend':Search.config.widgets[Search.result.display].gold}">
                        <!--                        -->
                        <!--  QUALITY SELECTION     -->
                        <!--                        -->
                        <div class="btn-group" ng-show="!isAdvancedMode()">
                            <button class="btn dropdown-toggle btn" type="button" ng-cloak data-toggle="dropdown"
                                    ng-show="Search.config.widgets[Search.result.display].gold" id="search-quality">
                                {{Search.config.widgets[Search.result.display].qualityLabel[Search.params.quality]}}
                                <span class="caret"></span>
                            </button>
                            <ul id="search-quality-dropdown" class="dropdown-menu"
                                ng-show="Search.config.widgets[Search.result.display].gold">
                                <li><a ng-click="quality('gold')">Gold only</a></li>
                                <li><a ng-click="quality('gold-and-silver')">Include silver</a></li>
                            </ul>
                        </div>

                        <!--                        -->
                        <!--  SEARCH TEXT FIELD     quality selection => width:65.812%; without => width:80.8%-->
                        <!--                        -->
                        <input ng-show="!isAdvancedMode()" id="search-query" class="" type="text"
                               ng-model="Search.params.query"
                               ng-class="{'quality-search-width':Search.config.widgets[Search.result.display].gold,'no-quality-search-width':!Search.config.widgets[Search.result.display].gold}"
                               autocomplete="off" bs-autocomplete="Search.suggest" autofocus>



                        <!--                        -->
                        <!--  Expert mode button    -->
                        <!--                        -->
                        <button id="adv-user-query" class="btn" type="button" ng-click="toogleSearchMode()"><i
                                class="{{(Search.params.mode == 'simple') ? 'icon-caret-down' : 'icon-caret-up'}} ajax-end"></i></button>

                        <!--                        -->
                        <!--  SEARCH BUTTON         -->
                        <!--                        -->
                        <button id="search-button" class="btn btn-primary" type="submit"
                                ng-disabled="(!Search.params.query || !Search.params.query.length) && !isAdvancedMode()"><i class="icon-search"></i>
                        </button>

                        <!--                      -->
                        <!--  CLEAN BUTTON        -->
                        <!--                      -->
                        <!--<button id="search-clear" class="btn" type="button" ng-click="clean({})"-->
                        <!--ng-disabled="!Search.params.query || !Search.params.query.length"><i-->
                        <!--class="icon-remove ajax-end"></i></button>-->

                                        <span ng-show="Search.result.spellcheck.collations.length"
                                              id="search-didyoumean"><b class="gray">
                                            &nbsp;Did you mean:</b>
                      <a href="{{Search.config.entityMapping[Search.params.entity]}}/search/{{Search.result.spellcheck.collations[0].query}}">{{Search.result.spellcheck.collations[0].query}}</a>
                      <span ng-show="Search.result.spellcheck.collations[1]">,
                        <a href="{{Search.config.entityMapping[Search.params.entity]}}/search/{{Search.result.spellcheck.collations[1].query}}">{{Search.result.spellcheck.collations[1].query}}</a>
                      </span>
                    </span>&nbsp;

                    </div>
                </div>
            </div>
            <div ng-include src="'partials/advanced/advanced-mode.html'"></div>
        </form>
    </div>
    <div class="row solrparams">
    </div>

</div>
  